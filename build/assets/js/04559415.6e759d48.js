"use strict";(self.webpackChunkgrc=self.webpackChunkgrc||[]).push([[2114],{198:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var a=n(5893),t=n(1151);const l={},i="WRF",s={id:"jarvis/jarvis-cd/packages/wrf",title:"WRF",description:"Installation",source:"@site/docs/05-jarvis/02-jarvis-cd/08-packages/wrf.md",sourceDirName:"05-jarvis/02-jarvis-cd/08-packages",slug:"/jarvis/jarvis-cd/packages/wrf",permalink:"/docs/jarvis/jarvis-cd/packages/wrf",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Nyx",permalink:"/docs/jarvis/jarvis-cd/packages/nyx"},next:{title:"Schedulers",permalink:"/docs/jarvis/jarvis-cd/schedulers"}},o={},c=[{value:"Installation",id:"installation",level:2},{value:"System Check",id:"system-check",level:3},{value:"Create a library folder and install the library",id:"create-a-library-folder-and-install-the-library",level:3},{value:"Choice 1: Install the library(with the HDF5 support and without PnetCDF support)",id:"choice-1-install-the-librarywith-the-hdf5-support-and-without-pnetcdf-support",level:3},{value:"Choice 2: Install the libarary(with both HDF5 support and PnetCDF support)",id:"choice-2-install-the-libararywith-both-hdf5-support-and-pnetcdf-support",level:3},{value:"Install WPS",id:"install-wps",level:3},{value:"Usage",id:"usage",level:2},{value:"Post Processing",id:"post-processing",level:2}];function d(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.h1,{id:"wrf",children:"WRF"}),"\n",(0,a.jsx)(r.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(r.h3,{id:"system-check",children:"System Check"}),"\n",(0,a.jsx)(r.p,{children:"Create a Test folder"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"mkdir TESTS\r\ncd TESTS\n"})}),"\n",(0,a.jsx)(r.p,{children:"Download the test cases and start tests, the output of tests should include SUCCESS"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/Fortran_C_tests.tar\r\ntar -xf Fortran_C_tests.tar\r\ngfortran TEST_1_fortran_only_fixed.f\r\n./a.out\r\ngfortran TEST_2_fortran_only_free.f90\r\n./a.out\r\ngcc TEST_3_c_only.c\r\n./a.out\r\ngcc -c -m64 TEST_4_fortran+c_c.c\r\ngfortran -c -m64 TEST_4_fortran+c_f.f90\r\ngfortran -m64 TEST_4_fortran+c_f.o TEST_4_fortran+c_c.o\r\n./a.out\r\n./TEST_csh.csh\r\n./TEST_perl.pl\r\n./TEST_sh.sh\n"})}),"\n",(0,a.jsx)(r.h3,{id:"create-a-library-folder-and-install-the-library",children:"Create a library folder and install the library"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"mkdir Build_WRF\r\ncd Build_WRF\r\nmkdir LIBRARIES\r\ncd LIBRARIES\n"})}),"\n",(0,a.jsx)(r.p,{children:"Download and unzip the required libraries."}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsx)(r.li,{children:"nedcdf-c-4.9.2"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget -c https://downloads.unidata.ucar.edu/netcdf-c/4.9.2/netcdf-c-4.9.2.tar.gz\r\ntar xzvf netcdf-c-4.9.2.tar.gz\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"2",children:["\n",(0,a.jsx)(r.li,{children:"hdf5(you can also install the newest version)"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget -c https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-1.12/hdf5-1.12.2/src/hdf5-1.12.2.tar.gz\r\ntar xzvf hdf5-1.12.2.tar.gz\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"3",children:["\n",(0,a.jsx)(r.li,{children:"zlib(1.2.11)"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget -c https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/zlib-1.2.11.tar.gz\r\ntar xzvf zlib-1.2.11.tar.gz\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"4",children:["\n",(0,a.jsx)(r.li,{children:"NETCDF-Fortran(4.6.1)"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget https://downloads.unidata.ucar.edu/netcdf-fortran/4.6.1/netcdf-fortran-4.6.1.tar.gz\r\ntar xzvf netcdf-fortran-4.6.1.tar.gz\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"5",children:["\n",(0,a.jsx)(r.li,{children:"PnetCDF(1.12.3)"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget https://parallel-netcdf.github.io/Release/pnetcdf-1.12.3.tar.gz\r\ntar xzvf pnetcdf-1.12.3.tar.gz\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"6",children:["\n",(0,a.jsx)(r.li,{children:"LibPNG"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wget -c https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/libpng-1.2.50.tar.gz\r\ntar xzvf libpng-1.2.50.tar.gz\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"7",children:["\n",(0,a.jsx)(r.li,{children:"MPICH\r\nwhen load the adios2, mpi is automatically loaded in PATH"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"module load adios2/2.9.1-6fh7kh2\n"})}),"\n",(0,a.jsx)(r.h3,{id:"choice-1-install-the-librarywith-the-hdf5-support-and-without-pnetcdf-support",children:"Choice 1: Install the library(with the HDF5 support and without PnetCDF support)"}),"\n",(0,a.jsx)(r.p,{children:"Set the environment variables"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"export DIR=/PATH/TO/Build_WRF/LIBRARIES\r\nexport CC=gcc\r\nexport CXX=g++\r\nexport FC=gfortran\r\nexport F77=gfortran\r\nmodule load libxml2\n"})}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsx)(r.li,{children:"Install the zlib"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"cd zlib-1.2.11/\r\n./configure --prefix=$DIR\r\nmake\r\nmake install\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"2",children:["\n",(0,a.jsx)(r.li,{children:"Install the hdf5"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"cd hdf5-1.12.2/\r\n./configure --prefix=$DIR --with-zlib=$DIR --enable-hl --enable-fortran\r\nmake check\r\nmake install\r\nexport HDF5=$DIR\r\nexport LD_LIBRARY_PATH=$DIR/lib:$LD_LIBRARY_PATH\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"3",children:["\n",(0,a.jsx)(r.li,{children:"Build NETCDF-C"}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"cd netcdf-c-4.9.2\r\nexport CPPFLAGS=-I$DIR/include\r\nexport LDFLAGS=-L$DIR/lib\r\n ./configure --prefix=$DIR --disable-dap\r\nmake check\r\nmake install\r\nexport PATH=$DIR/bin:$PATH\r\nexport NETCDF=$DIR\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"4",children:["\n",(0,a.jsxs)(r.li,{children:["Build NetCDF fortran library links with NETCDF-C, after successful installation,\r\nnetcdf.inc will be ",(0,a.jsx)(r.code,{children:"${NETCDF}/include"}),' file.\r\nFor sometimes, it will show C compiler stop working, Please check the environment variable in\r\nLIBS="-lnetcdf -lhdf5_hl -lhdf5 -lz", make sure netcdf and hdf5 path in the environment variables.']}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:'export LD_LIBRARY_PATH=$DIR/lib:$LD_LIBRARY_PATH\r\nexport CPPFLAGS="-I${DIR}/include -I/usr/include"\r\nexport LDFLAGS="-L${DIR}/lib -L/usr/lib"\r\nexport LIBS="-lnetcdf -lhdf5_hl -lhdf5 -lz"\r\n./configure --prefix=$DIR --disable-shared\r\nmake check\r\nmake install\n'})}),"\n",(0,a.jsx)(r.p,{children:"Library Compatibility Tests( the result should show SUCCESS)"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"mkdir LibTests\r\ncd libTests\r\nwget https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/Fortran_C_NETCDF_MPI_tests.tar\r\ntar -xf Fortran_C_NETCDF_MPI_tests.tar\r\ncp ${NETCDF}/include/netcdf.inc .\r\ngfortran -c 01_fortran+c+netcdf_f.f\r\ngcc -c 01_fortran+c+netcdf_c.c\r\ngfortran 01_fortran+c+netcdf_f.o 01_fortran+c+netcdf_c.o \\\r\n     -L${NETCDF}/lib -lnetcdff -lnetcdf\r\n./a.out\n"})}),"\n",(0,a.jsxs)(r.ol,{start:"5",children:["\n",(0,a.jsx)(r.li,{children:"Install the WRF\r\nThe adios2 need to be installed with c-blocs, mpi, and hdf5."}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-Bash",children:'cd ..\r\nwget https://github.com/wrf-model/WRF/releases/download/v4.5.1/v4.5.1.tar.gz\r\ntar xvzf v4.5.1.tar.gz\r\ncd WRFV4.5.1\r\nmodule load adios2/2.9.1-6fh7kh2\r\nexport ADIOS2="/mnt/repo/software/spack/spack/opt/spack/linux-ubuntu22.04-skylake_avx512/gcc-11.3.0/adios2-2.9.1-6fh7kh2v3tombadg56kmop72sjhf23dg"\r\nexport HDF5=$DIR\r\nexport NETCDF=$DIR\r\nexport NETCDF_classic=1\r\n./configure\n'})}),"\n",(0,a.jsx)(r.p,{children:"Please select from among the following Linux x86_64 options:\r\nChoose 34(dmpar),\r\nCompile for nesting?\r\nchoose 1.\r\nIf configure is done, you can see a configure.wrf file in the folder."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"./compile em_real\r\n #./compile em_real >& log.compile\r\nexport WRF_DIR=PATH/to/WRFV4.5.1\n"})}),"\n",(0,a.jsx)(r.p,{children:"You can see the following information shows the installation is successful."}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"---\x3e                  Executables successfully built                  <---\r\n -rwxrwxr-x 1 hxu40 hxu40 51667784 Sep 15 12:21 main/ndown.exe\r\n -rwxrwxr-x 1 hxu40 hxu40 51794800 Sep 15 12:21 main/real.exe\r\n -rwxrwxr-x 1 hxu40 hxu40 50930720 Sep 15 12:21 main/tc.exe\r\n -rwxrwxr-x 1 hxu40 hxu40 59885752 Sep 15 12:21 main/wrf.exe\r\n\r\n==========================================================================\n"})}),"\n",(0,a.jsx)(r.p,{children:"To check check whether it was successful"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"ls -ls main/*.exe\n"})}),"\n",(0,a.jsx)(r.p,{children:"If you compiled a real case, you should see:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"wrf.exe (model executable)\r\nreal.exe (real data initialization)\r\nndown.exe (one-way nesting)\r\ntc.exe (for tc bogusing--serial only)\n"})}),"\n",(0,a.jsx)(r.h3,{id:"choice-2-install-the-libararywith-both-hdf5-support-and-pnetcdf-support",children:"Choice 2: Install the libarary(with both HDF5 support and PnetCDF support)"}),"\n",(0,a.jsx)(r.p,{children:"TBD, Looks like not necessary for this case"}),"\n",(0,a.jsx)(r.h3,{id:"install-wps",children:"Install WPS"}),"\n",(0,a.jsx)(r.p,{children:"Download and install required library"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"cd $DIR\r\nwget https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/libpng-1.2.50.tar.gz\r\ntar xzvf libpng-1.2.50.tar.gz\r\ncd libpng-1.2.50\r\n./configure --prefix=$DIR/grib2\r\nmake\r\nmake install\r\ncd ..\r\nwget https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/jasper-1.900.1.tar.gz\r\ntar xzvf jasper-1.900.1.tar.gz\r\ncd jasper-1.900.1\r\n./configure --prefix=$DIR/grib2\r\nmake\r\nmake install\r\ncd ..\r\ncd $DIR\r\ncd zlib_1.22.1\r\n./configure --prefix=$DIR/grib2\r\nmake\r\nmake install\r\nexport JASPERLIB=$DIR/grib2/lib\r\nexport JASPERINC=$DIR/grib2/include\n"})}),"\n",(0,a.jsx)(r.p,{children:"Download WPS and install"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"#go to WRF folder\r\nmkdir WPS\r\nwget https://github.com/wrf-model/WPS/archive/v4.5.tar.gz\r\ntar -xvzf v4.5.tar.gz\r\ncd WPS-4.5\r\nexport JASPERLIB=$DIR/grib2/lib\r\nexport JASPERINC=$DIR/grib2/include\r\n./configure --build-grib2-libs #Option 3 for gfortran and distributed memory\r\n./compile\n"})}),"\n",(0,a.jsx)(r.p,{children:"IF you see this message after ./configure, please ignore"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"Testing for NetCDF, C and Fortran compiler\r\nThis installation NetCDF is 64-bit\r\nC compiler is 64-bit\r\nFortran compiler is 64-bit\r\nYour versions of Fortran and NETCDF are not consistent.\r\n```bash\r\n\r\nIf the compile successfully,\r\nthere should be 3 executables in the WPS top-level directory, that are linked to their corresponding src/ directories:\r\n```bash\r\ngeogrid.exe -> geogrid/src/geogrid.exe\r\nungrib.exe -> ungrib/src/ungrib.exe\r\nmetgrid.exe -> metgrid/src/metgrid.exe\n"})}),"\n",(0,a.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsxs)(r.ol,{children:["\n",(0,a.jsxs)(r.li,{children:["Download the benchmark dataset, here is the website for dataset:\r\n",(0,a.jsx)(r.a,{href:"https://www2.mmm.ucar.edu/wrf/users/benchmark/v44/benchdata_v44.html",children:"https://www2.mmm.ucar.edu/wrf/users/benchmark/v44/benchdata_v44.html"}),"\r\nChoose one of them for testing.\r\nUnzip the file.\r\ncopy the wrfbdy_d01, wrfinput_d01 and namelist.input file to WRF/test/em_real file."]}),"\n"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{children:"change the namelist.input file\r\nThe ADIOS2 I/O option for history and/or restart file is enabled by setting one of the following:\r\nio_form_history = 14\r\nio_form_restart = 14\r\nframes_per_outfile   = 1000000,\r\nhistory_outname      = '/Path/to/output/wrfout_d<domain>_<date>' (this part also can be changed in WRF/Register/register.io_bipartitie file)\r\nDo not change the wrfout_d<domain>_<date>\n"})}),"\n",(0,a.jsx)(r.p,{children:"Run wrf with adios2\r\nadd adios2.xml file in the same folder(wrf/test/em_real)\r\nHere is the example of adios2.xml file:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:'<?xml version="1.0"?>\r\n<adios-config>\r\n\r\n  \x3c!-- <io name="/Path/to/wrfout_d01_2018-06-17_00:00:00"> --\x3e\r\n  <io name="/Path/to/wrfout_d01_2019-11-26_12:00:00">\r\n\r\n    \x3c!-- <engine type="BP4"> --\x3e\r\n    \x3c!-- </engine> --\x3e\r\n\r\n    <engine type="BP4">\r\n      <parameter key="RendezvousReaderCount" value="0"/>\r\n      <parameter key="QueueLimit" value="1"/>\r\n      <parameter key="QueueFullPolicy" value="Discard"/>\r\n      <parameter key="OpenTimeoutSecs" value="30.0"/>\r\n    </engine>\r\n\r\n    \x3c!-- <engine type="BP4"> --\x3e\r\n      \x3c!-- <parameter key="AggregatorRatio" value="18"/> --\x3e\r\n      \x3c!-- <parameter key="NumAggregators" value="36"/> --\x3e\r\n      \x3c!-- <parameter key="BurstBufferPath" value="/mnt/local/mike"/> --\x3e\r\n      \x3c!-- <parameter key="BurstBufferDrain" value="Off"/> --\x3e\r\n      \x3c!-- <parameter key="BurstBufferVerbose" value="1"/> --\x3e\r\n    \x3c!-- </engine> --\x3e\r\n  </io>\r\n</adios-config>\r\n\n'})}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"module load adios2/2.9.1-6fh7kh2\r\nexport DIR=~/Build_WRF/LIBRARIES\r\nexport CC=gcc\r\nexport CXX=g++\r\nexport FC=gfortran\r\nexport F77=gfortran\r\nexport HDF5=$DIR\r\nexport LD_LIBRARY_PATH=$DIR/lib:$LD_LIBRARY_PATH\r\nexport NETCDF=$DIR\r\nexport PATH=$DIR/bin:$PATH\r\nexport LD_LIBRARY_PATH=/mnt/repo/software/spack/spack/opt/spack/linux-ubuntu22.04-skylake_avx512/gcc-11.3.0/adios2-2.9.1-6fh7kh2v3tombadg56kmop72sjhf23dg/lib:$LD_LIBRARY_PATH\r\n./wrf.exe or(mpirun -np <number of process> ./wrf.exe\n"})}),"\n",(0,a.jsx)(r.p,{children:'The BP5 output will have mmd.0 file and the BP4 does not have mmd.0 file\r\nTHe output file has the same name for different machine: "wrfout_d01_2019-11-26_12:00:00"'}),"\n",(0,a.jsx)(r.h2,{id:"post-processing",children:"Post Processing"}),"\n",(0,a.jsx)(r.p,{children:"Here is the python script. Then add the same adios2.xml file into the same folder with python"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:'import argparse\r\nimport adios2                               # pylint: disable=import-error\r\nimport numpy as np                          # pylint: disable=import-error\r\nimport matplotlib.pyplot as plt             # pylint: disable=import-error\r\nimport matplotlib.gridspec as gridspec      # pylint: disable=import-error\r\nfrom mpi4py import MPI                      # pylint: disable=import-error\r\nimport cartopy.crs as ccrs                  # pylint: disable=import-error\r\nimport cartopy.feature as cfeature          # pylint: disable=import-error\r\nfrom mpl_toolkits.axes_grid1 import make_axes_locatable # pylint: disable=import-error\r\n#\r\n#\r\ndef setup_args():\r\n    parser = argparse.ArgumentParser()\r\n    parser.add_argument("--instream", "-i", help="Name of the input stream", default="wrfout_d01_2019-11-26_23:00:00")\r\n    parser.add_argument("--outfile", "-o", help="Name of the output file", default="screen")\r\n    parser.add_argument("--varname", "-v", help="Name of variable read", default="T2")\r\n    args = parser.parse_args()\r\n    return args\r\n\r\ndef plot_var(var, fr_step):\r\n\r\n    lccproj = ccrs.LambertConformal(central_longitude=-74.5, central_latitude=38.8)\r\n    fig, ax = plt.subplots(figsize=(15, 18), subplot_kw=dict(projection=lccproj))\r\n    plt.subplots_adjust(right=0.88)  # adjust the right margin of the plot\r\n    title = fr_step.read_string("Times")\r\n    plt.title("WRF-ADIOS2 Demo \\n {}".format(title[0]), fontsize=17)\r\n\r\n     # format the spacing of the colorbar\r\n    divider = make_axes_locatable(ax)\r\n    cax = divider.new_horizontal(size=\'5%\', pad=0.1, axes_class=plt.Axes)\r\n    fig.add_axes(cax)\r\n\r\n    displaysec = 0.5\r\n    cur_step = fr_step.current_step()\r\n    x = fr_step.read("XLONG")\r\n    y = fr_step.read("XLAT")\r\n    data = fr_step.read(var)\r\n    print(data)\r\n    data = data * 9 / 5 - 459.67 #convert from K to F\r\n\r\n    # define the limits for the model to subset and plot\r\n    # model_lims = dict(minlon=-80, maxlon=-69, minlat=35, maxlat=43)\r\n\r\n    # # create boolean indices where lat/lon are within defined boundaries\r\n    # lon_ind = np.logical_and(x > model_lims[\'minlon\'], x < model_lims[\'maxlon\'])\r\n    # lat_ind = np.logical_and(y > model_lims[\'minlat\'], y < model_lims[\'maxlat\'])\r\n    # # find i and j indices of lon/lat in boundaries\r\n    # ind = np.where(np.logical_and(lon_ind, lat_ind))\r\n\r\n    # data = np.squeeze(data)[range(np.min(ind[0]), np.max(ind[0]) + 1),\r\n    #                 range(np.min(ind[1]), np.max(ind[1]) + 1)]\r\n\r\n    h = ax.pcolormesh(x, y, data, vmin=-20, vmax=110,\r\n                      cmap=\'jet\', transform=ccrs.PlateCarree())\r\n\r\n    cb = plt.colorbar(h, cax=cax)\r\n    cb.set_label(label="Temperature [F]", fontsize=14)  # add the label on the colorbar\r\n    cb.ax.tick_params(labelsize=12)  # format the size of the tick labels\r\n\r\n    # add contours\r\n    contour_list = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]  # define contour levels\r\n    cs = ax.contour(x, y, data, contour_list, colors=\'black\',\r\n                    linewidths=.5, transform=ccrs.PlateCarree())\r\n    ax.clabel(cs, inline=True, fontsize=10.5, fmt=\'%d\')\r\n\r\n    # add the latitude and longitude gridlines\r\n    gl = ax.gridlines(draw_labels=True, linewidth=1, color=\'gray\', alpha=0.5,\r\n                      linestyle=\'dotted\', x_inline=False)\r\n    gl.top_labels = False\r\n    gl.right_labels = False\r\n    gl.xlabel_style = {\'size\': 13}\r\n    gl.ylabel_style = {\'size\': 13}\r\n\r\n     # add map features\r\n    land = cfeature.NaturalEarthFeature(\'physical\', \'land\', \'10m\')\r\n    ax.add_feature(land, zorder=5, edgecolor=\'black\', facecolor=\'none\')\r\n\r\n    state_lines = cfeature.NaturalEarthFeature(\r\n        category=\'cultural\',\r\n        name=\'admin_1_states_provinces_lines\',\r\n        scale=\'10m\',\r\n        facecolor=\'none\')\r\n\r\n    ax.add_feature(cfeature.BORDERS, zorder=6)\r\n    ax.add_feature(state_lines, zorder=7, edgecolor=\'black\')\r\n\r\n    #plt.title(title)\r\n\r\n    # plt.ion()\r\n    #plt.show()\r\n    # plt.pause(displaysec)\r\n    # #clear_output()\r\n    # plt.clf()\r\n\r\n    imgfile = "image"+"{0:0>5}.png".format(cur_step)\r\n    plt.savefig(imgfile)\r\n    plt.clf()\r\n\r\nif __name__ == "__main__":\r\n    args = setup_args()\r\n    fr = adios2.open(args.instream, "r", MPI.COMM_WORLD, "adios2.xml", "wrfout_d01_2019-11-26_23:00:00")\r\n\r\n    for fr_step in fr:\r\n        plot_var(args.varname, fr_step)\r\n\r\n    fr.close()\r\n\n'})}),"\n",(0,a.jsx)(r.p,{children:"Run this python script with adios2.xml file in the same folder."})]})}function h(e={}){const{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},1151:(e,r,n)=>{n.d(r,{Z:()=>s,a:()=>i});var a=n(7294);const t={},l=a.createContext(t);function i(e){const r=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(l.Provider,{value:r},e.children)}}}]);