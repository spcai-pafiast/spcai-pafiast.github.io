"use strict";(self.webpackChunkgrc=self.webpackChunkgrc||[]).push([[5945],{4785:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=t(5893),r=t(1151);const s={},a="Debugging",o={id:"hermes/debugging",title:"Debugging",description:"Hermes can be complicated to debug due to its distributed and asynchronous",source:"@site/docs/03-hermes/09-debugging.md",sourceDirName:"03-hermes",slug:"/hermes/debugging",permalink:"/docs/hermes/debugging",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Quick Start Guide",permalink:"/docs/hermes/quick-start"},next:{title:"Doxygen",permalink:"/docs/hermes/doxygen"}},l={},c=[{value:"Preparing For Release",id:"preparing-for-release",level:2},{value:"Preparing Pull Request (PR)",id:"preparing-pull-request-pr",level:3},{value:"PR Check Failure",id:"pr-check-failure",level:3},{value:"Introduction to our Continuous Integration (CI)",id:"introduction-to-our-continuous-integration-ci",level:2},{value:"API Test",id:"api-test",level:3},{value:"Adding a New Adapter",id:"adding-a-new-adapter",level:2},{value:"Customizing Data Placement Engine",id:"customizing-data-placement-engine",level:2},{value:"Codes for Testing DPE",id:"codes-for-testing-dpe",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"debugging",children:"Debugging"}),"\n",(0,i.jsx)(n.p,{children:"Hermes can be complicated to debug due to its distributed and asynchronous\nnature. Faults can happen in the client program, or in the Hermes daemon.\nThe first step when encountering problems is to compile in Debug mode."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cmake",children:"cmake .. -DCMAKE_BUILD_TYPE=Debug\n"})}),"\n",(0,i.jsx)(n.p,{children:"The Debug mode will increase the number of logging statements the program\nuses to give you a stronger hint as to where the problem occurs. These\nstatements are typically compiled out for performance reasons."}),"\n",(0,i.jsx)(n.p,{children:"Secondly, make sure to use an IDE which supports visual debugging. Debugging\nusing a terminal with gdb can be very cumbersome, especially when multi-process\ncases come along."}),"\n",(0,i.jsx)(n.h2,{id:"preparing-for-release",children:"Preparing For Release"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create a GitHub Project for the ",(0,i.jsx)(n.em,{children:"next"})," release"]}),"\n",(0,i.jsxs)(n.li,{children:["Update the ",(0,i.jsx)(n.code,{children:"HERMES_VERSION_*"})," variables in ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n",(0,i.jsxs)(n.li,{children:["Update ",(0,i.jsx)(n.code,{children:"PROJECT_NUMBER"})," in ",(0,i.jsx)(n.code,{children:"Doxyfile.in"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"To make release note generation as automated as possible, make sure\nrelevant pull requests that are part of the release have proper labels and and\ntitles, as that information will show up directly in the generated release\nnotes in the next step."}),"\n",(0,i.jsxs)(n.li,{children:["Draft a release on Github. Click ",(0,i.jsx)(n.code,{children:"auto-generate release notes"}),' and edit\nthe result as necessary. Fill in the new tag, and select "Create new tag x.x.x\non publish" so that Github will automatically tag the release when it is\npublished.']}),"\n",(0,i.jsx)(n.li,{children:"The docker containers will be automatically built and pushed to docker hub\nwhenever a new tag is added. Check the CI actions to make sure there were no\nerrors."}),"\n",(0,i.jsx)(n.li,{children:"Copy/move ideas to the project for the next release"}),"\n",(0,i.jsxs)(n.li,{children:["Close and archive the project for the ",(0,i.jsx)(n.em,{children:"current"})," release"]}),"\n",(0,i.jsxs)(n.li,{children:["Merge the latest release branch (if one exists) of the wiki into the ",(0,i.jsx)(n.code,{children:"master"})," branch."]}),"\n",(0,i.jsx)(n.li,{children:"Make an announcement in the Hermes topic of the HDF forum."}),"\n",(0,i.jsx)(n.li,{children:"Send Lori a note for the next HDF5 newsletter."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"preparing-pull-request-pr",children:"Preparing Pull Request (PR)"}),"\n",(0,i.jsx)(n.p,{children:"Please run these two steps and remove all warnings."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"make dox\nmake lint\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pr-check-failure",children:"PR Check Failure"}),"\n",(0,i.jsxs)(n.p,{children:['GitHub Actions for PR check may fail because it uses a Spack cache.\nThe cache does not have to change often (unless you\'ve added dependencies),\nso this should be done only in this case. To refresh the github cache,\nmodify the file "ci/install_deps.sh" in some way. For\nexample, by adding a comment. If you check the ',(0,i.jsx)(n.a,{href:"https://github.com/HDFGroup/hermes/blob/master/.github/workflows/main.yml",children:"github workflow which produces\nthe cache"}),", it uses a hash\nof install_deps.sh to locate a cache."]}),"\n",(0,i.jsx)(n.h2,{id:"introduction-to-our-continuous-integration-ci",children:"Introduction to our Continuous Integration (CI)"}),"\n",(0,i.jsxs)(n.p,{children:["We are primarily using Python for managing for running unit tests. Under\n",(0,i.jsx)(n.a,{href:"https://github.com/HDFGroup/hermes/blob/master/CMakeLists.txt",children:"our root CMakeList"}),", we implement a\nCMake function called pytest, which wraps around the Python testing\nframework called py_hermes_ci, which is located under ci/py_hermes_ci."]}),"\n",(0,i.jsx)(n.p,{children:"Fundamentally, py_hermes_ci relies on our library jarvis-util,\n(located under ci/jarvis-util), which provides utilities to execute\nbinaries in Python."}),"\n",(0,i.jsx)(n.h3,{id:"api-test",children:"API Test"}),"\n",(0,i.jsxs)(n.p,{children:["Update ",(0,i.jsx)(n.code,{children:"test/CMakeLists.txt"})," with your new .cc test code name.\nFor example, if you add ",(0,i.jsx)(n.code,{children:"trait_order.cc"}),", add ",(0,i.jsx)(n.code,{children:"trait_order"})," as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"set(API_TESTS dpe_optimization_test dpe_random_test\n    dpe_roundrobin_test end_to_end_test vbucket_test trait_order)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"adding-a-new-adapter",children:"Adding a New Adapter"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create a new directory under the ",(0,i.jsx)(n.code,{children:"adapter"})," directory."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"customizing-data-placement-engine",children:"Customizing Data Placement Engine"}),"\n",(0,i.jsx)(n.p,{children:"Data Placement Engine (DPE) is the heart of Hermes performance.\nDevelopers may want to replace the default engine using different optimization algorithms."}),"\n",(0,i.jsx)(n.h3,{id:"codes-for-testing-dpe",children:"Codes for Testing DPE"}),"\n",(0,i.jsx)(n.p,{children:"You can quickly check how DPE is tested."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/HDFGroup/hermes/blob/master/test/dpe_optimization_test.cc",children:"test/dpe_optimization_test.cc"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>a});var i=t(7294);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);